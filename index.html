<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="技术 | javascript | html | 前端学习">
<meta property="og:type" content="website">
<meta property="og:title" content="王羽彪 |  学习前端">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="王羽彪 |  学习前端">
<meta property="og:description" content="技术 | javascript | html | 前端学习">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="王羽彪 |  学习前端">
<meta name="twitter:description" content="技术 | javascript | html | 前端学习">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>王羽彪 |  学习前端</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">王羽彪 |  学习前端</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/08/vuex/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王羽彪">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王羽彪 |  学习前端">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/08/vuex/" itemprop="url">'vuex'</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-08T10:26:18+08:00">
                2017-07-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Vuex"><a href="#Vuex" class="headerlink" title="Vuex"></a>Vuex</h2><p>Vuex是一个转为Vue.js程序开发的状态管理模式.用来几种管理所有组件的状态,并以响应的规则保证状态以一种可预测的方式发生变化.</p>
<ul>
<li><a href="https://github.com/vuejs/vue-devtools" target="_blank" rel="external">Vue的官方调试工具</a></li>
</ul>
<p>状态管理应用包含三个部分</p>
<ol>
<li>state, 驱动应用的数据源</li>
<li>view, 以声明方式将state映射到视图</li>
<li>actions, 响应在view上的用户输入导致的状态变化</li>
</ol>
<p>全局单例模式管理,可以将组建构成一个巨大的’视图’,不管在树的哪个位置,任何组建都能获取状态或者触发行为!</p>
<p>在简单的页面下可以使用event bus($on,$off,$emit)</p>
<ol>
<li>没一个Vuex应用的核心就是store,’store’基本上就是一个容器,包含着应用中的大部state。Vuex和单纯的全局对象有一下两点不同:<ul>
<li>状态储存响应式</li>
<li>不能直接改变store中的state</li>
</ul>
</li>
</ol>
<h2 id="store-最简单的store实现"><a href="#store-最简单的store实现" class="headerlink" title="store 最简单的store实现"></a>store 最简单的store实现</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">const store = new Vuex.Store(&#123;</div><div class="line">    state:&#123;count:0&#125;,</div><div class="line">    matations:&#123;</div><div class="line">        increment(state)&#123;state.count++&#125;</div><div class="line">    &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h2 id="State-单一状态树"><a href="#State-单一状态树" class="headerlink" title="State 单一状态树"></a>State 单一状态树</h2><p>Vuex使用单一状态树 – 用一个对象包含了全部的应用层级状态.作为一个（唯一数据源存在）SSOT.</p>
<h2 id="在Vue组件中获得Vuex状态"><a href="#在Vue组件中获得Vuex状态" class="headerlink" title="在Vue组件中获得Vuex状态"></a>在Vue组件中获得Vuex状态</h2><p>Vuex 的状态储存是响应式的，从store实例中读取状态最简单的是在计算属性(computed)中直接返回某个状态<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">const Counter = &#123;</div><div class="line">    template:`&lt;div&gt;&#123;&#123;count&#125;&#125;&lt;/div&gt;`,</div><div class="line">    computed()&#123;</div><div class="line">        count()&#123;</div><div class="line">            return store.state.count</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">//在创建Vue实例时注入组件中(Vue.use(Vuex))</div><div class="line">const app = new Vue(&#123;sotre&#125;)</div></pre></td></tr></table></figure></p>
<p>每当store.state.count变化的时候,都会重新求取计算属性,并且触发更新相关联的DOM.</p>
<blockquote>
<p>注入后能够通过<code>this.$store</code>访问到</p>
</blockquote>
<h2 id="mapState-辅助函数"><a href="#mapState-辅助函数" class="headerlink" title="mapState 辅助函数"></a>mapState 辅助函数</h2><p>当组件需要获取多个状态的时候,将这些状态都声明为计算属性会有些重复和冗余,因此使用<code>mapState()</code>可以帮助我们生成计算属性</p>
<figure class="highlight plain"><figcaption><span>js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">import &#123;mapState&#125; from &apos;vuex&apos;</div><div class="line">export default&#123;</div><div class="line">    computed:mapState(&#123;</div><div class="line">        count:state=&gt;state.count,</div><div class="line">        </div><div class="line">        //传字符串参数&apos;count&apos;等同于&apos;state=&gt;state.count&apos;</div><div class="line">        countAlias:&apos;count&apos;,</div><div class="line">        </div><div class="line">        //为了能够使用this获取局部状态,必须使用常规函数</div><div class="line">       countPlusLocalState (state)&#123;</div><div class="line">            return state.count+this.localCount</div><div class="line">       &#125;</div><div class="line">    &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>当映射的计算属性的名称与state的子节点名称相同时,可以给mapState传递一个数组<br><figure class="highlight plain"><figcaption><span>js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">computed:mapState([&apos;count&apos;])</div></pre></td></tr></table></figure></p>
<h2 id="对象展开运算符"><a href="#对象展开运算符" class="headerlink" title="对象展开运算符"></a>对象展开运算符</h2><figure class="highlight plain"><figcaption><span>js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">computed:&#123;</div><div class="line">    localComputed()&#123;&#125;,</div><div class="line">    ...mapstate(&#123;</div><div class="line">        // ...</div><div class="line">    &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Getter"><a href="#Getter" class="headerlink" title="Getter"></a>Getter</h2><p>有时候我们需要从store中的state中派生出一些状态,例如对列表进行过滤并计数<br><figure class="highlight plain"><figcaption><span>js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">computed: &#123;</div><div class="line">  doneTodosCount () &#123;</div><div class="line">    return this.$store.state.todos.filter(todo =&gt; todo.done).length</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Vuex 允许在store中定义getters对象</p>
<figure class="highlight plain"><figcaption><span>js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">const store = new Vuex.Store(&#123;</div><div class="line">  state: &#123;</div><div class="line">    todos: [</div><div class="line">      &#123; id: 1, text: &apos;...&apos;, done: true &#125;,</div><div class="line">      &#123; id: 2, text: &apos;...&apos;, done: false &#125;</div><div class="line">    ]</div><div class="line">  &#125;,</div><div class="line">  getters: &#123;</div><div class="line">    doneTodos: state =&gt; &#123;</div><div class="line">      return state.todos.filter(todo =&gt; todo.done)</div><div class="line">    &#125;,</div><div class="line">    // Getters可以接收getters作为第二个参数</div><div class="line">     doneTodosCount: (state, getters) =&gt; &#123;</div><div class="line">        return getters.doneTodos.length</div><div class="line">      &#125;</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line"></div><div class="line">//可以较为容易的在任何组件中使用它:</div><div class="line"></div><div class="line">computed:&#123;</div><div class="line">    donTodosCount()&#123;</div><div class="line">        return this.$store.getters.doneTodosCount</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="mapGetters-辅助函数"><a href="#mapGetters-辅助函数" class="headerlink" title="mapGetters 辅助函数"></a>mapGetters 辅助函数</h2><figure class="highlight plain"><figcaption><span>js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">import &#123; mapGetters &#125; from &apos;vuex&apos;</div><div class="line"></div><div class="line">export default &#123;</div><div class="line">  // ...</div><div class="line">  computed: &#123;</div><div class="line">  // 使用对象展开运算符将 getters 混入 computed 对象中</div><div class="line">    ...mapGetters([</div><div class="line">      &apos;doneTodosCount&apos;,</div><div class="line">      &apos;anotherGetter&apos;,</div><div class="line">      // ...</div><div class="line">    ])</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">    //将一个 getter 属性另取一个名字，使用对象形式：</div><div class="line"></div><div class="line">mapGetters(&#123;</div><div class="line">  // 映射 this.doneCount 为 store.getters.doneTodosCount</div><div class="line">  doneCount: &apos;doneTodosCount&apos;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h2 id="Mutations"><a href="#Mutations" class="headerlink" title="Mutations"></a>Mutations</h2><p>更改Vuex的sotre中的位移方法是提交matation。每个mutation都有一个字符串的type和一个handler().这个回调函数就是我们实际进行状态修改的地方，并且它会接收state作为第一个参数</p>
<figure class="highlight plain"><figcaption><span>js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">const store = new Vuex.Store(&#123;</div><div class="line">  state: &#123;</div><div class="line">    count: 1</div><div class="line">  &#125;,</div><div class="line">  mutations: &#123;</div><div class="line">    increment (state) &#123;</div><div class="line">      // 变更状态</div><div class="line">      state.count++</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>需要在组件中调用相应的type调用store.commit方法:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">mutations定义的方法可以传入第二个参数即荷载(payload)</div><div class="line">```apple js</div><div class="line">    // ...</div><div class="line">    mutations: &#123;</div><div class="line">      increment (state, n) &#123;</div><div class="line">        state.count += n</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    store.commit(&apos;increment&apos;, 10)</div></pre></td></tr></table></figure></p>
<p>大多数请概况下payload应该是一个Object,这样可以包含多个字段并且记录mutation会更易读</p>
<p>提交mutation的另一种风格<br><figure class="highlight plain"><figcaption><span>js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">store.commit(&#123;</div><div class="line">  type: &apos;increment&apos;,</div><div class="line">  amount: 10    //payload</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>Mutations需要遵守的Vue的响应规则</p>
<ol>
<li>最好在store中初始化好所有所需属性</li>
<li>当需要在对象上添加新属性时,你应该<ul>
<li>是用<code>Vue.set(obj,&#39;newProp&#39;,12)</code></li>
<li>以新对象替换老对象:<code>state.obj = {...state.obj,newProp:123}</code></li>
</ul>
</li>
</ol>
<blockquote>
<p>mutations方法名称最好用常量替代<br>mutations 必须是同步函数<br>在组件中使用<code>this.$store.commit(&#39;xxx&#39;)</code>提交mutation,或者使用<code>mapMutations()</code>将组件中的methods映射为store.commit调用<br><figure class="highlight plain"><figcaption><span>js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">import &#123; mapMutations &#125; from &apos;vuex&apos;</div><div class="line"></div><div class="line">export default &#123;</div><div class="line">  // ...</div><div class="line">  methods: &#123;</div><div class="line">    ...mapMutations([</div><div class="line">      &apos;increment&apos; // 映射 this.increment() 为 this.$store.commit(&apos;increment&apos;)</div><div class="line">    ]),</div><div class="line">    ...mapMutations(&#123;</div><div class="line">      add: &apos;increment&apos; // 映射 this.add() 为 this.$store.commit(&apos;increment&apos;)</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<h2 id="Actions"><a href="#Actions" class="headerlink" title="Actions"></a>Actions</h2><p>Action类类似于mutation,不同在于:</p>
<pre><code>- Action提交的是mutation,而不是直接变更状态
- Action可以包含任意异步操作
</code></pre><figure class="highlight plain"><figcaption><span>js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">const store = new Vuex.Store(&#123;</div><div class="line">  state: &#123;</div><div class="line">    count: 0</div><div class="line">  &#125;,</div><div class="line">  mutations: &#123;</div><div class="line">    increment (state) &#123;</div><div class="line">      state.count++</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  actions: &#123;</div><div class="line">    increment (context) &#123;</div><div class="line">      context.commit(&apos;increment&apos;)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>Action函数接收一个与store对象具有相同方法和属性的context对象。</p>
<p>可以用到结构赋值<br><figure class="highlight plain"><figcaption><span>js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">actions:&#123;</div><div class="line">increment(&#123;commit&#125;)&#123;</div><div class="line">    commit(&apos;increment&apos;)</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="通过store-dispatch-方法触发"><a href="#通过store-dispatch-方法触发" class="headerlink" title="通过store.dispatch()方法触发"></a>通过<code>store.dispatch()</code>方法触发</h2><figure class="highlight plain"><figcaption><span>js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">store.dispatch(&apos;increment&apos;);</div></pre></td></tr></table></figure>
<ol>
<li>可以内嵌异步方法</li>
<li>Actions同Mutation一样支持payload和对象方式进行发布</li>
<li>调用异步API和分发多从mutations<h2 id="购物车例子"><a href="#购物车例子" class="headerlink" title="购物车例子"></a>购物车例子</h2><figure class="highlight plain"><figcaption><span>js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">actions: &#123;</div><div class="line">  checkout (&#123; commit, state &#125;, products) &#123;</div><div class="line">    // 把当前购物车的物品备份起来</div><div class="line">    const savedCartItems = [...state.cart.added]</div><div class="line">    // 发出结账请求，然后乐观地清空购物车</div><div class="line">    commit(types.CHECKOUT_REQUEST)</div><div class="line">    // 购物 API 接受一个成功回调和一个失败回调</div><div class="line">    shop.buyProducts(</div><div class="line">      products,</div><div class="line">      // 成功操作</div><div class="line">      () =&gt; commit(types.CHECKOUT_SUCCESS),</div><div class="line">      // 失败操作</div><div class="line">      () =&gt; commit(types.CHECKOUT_FAILURE, savedCartItems)</div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="组件中分发Action"><a href="#组件中分发Action" class="headerlink" title="组件中分发Action"></a>组件中分发Action</h2><p>在组件中使用<code>this.$store.dispatch(&#39;xxx&#39;)</code>分发action,或者使用<code>mapActions()</code>辅助函数将组件的methods映射为store.dispatch调用<br><figure class="highlight plain"><figcaption><span>js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">import &#123; mapActions &#125; from &apos;vuex&apos;</div><div class="line"></div><div class="line">export default &#123;</div><div class="line">  // ...</div><div class="line">  methods: &#123;</div><div class="line">    ...mapActions([</div><div class="line">      &apos;increment&apos; // 映射 this.increment() 为 this.$store.dispatch(&apos;increment&apos;)</div><div class="line">    ]),</div><div class="line">    ...mapActions(&#123;</div><div class="line">      add: &apos;increment&apos; // 映射 this.add() 为 this.$store.dispatch(&apos;increment&apos;)</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="组合Actions"><a href="#组合Actions" class="headerlink" title="组合Actions"></a>组合Actions</h2><p><code>dispatch()</code>可以处理被触发的action的回调函数返回的Promise,并且store.dispatch()返回的仍旧是Promise<br><figure class="highlight plain"><figcaption><span>js</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">actions:&#123;</div><div class="line">    actionA(&#123;commit&#125;)&#123;</div><div class="line">        return Promise((resolve,reject)=&gt;&#123;</div><div class="line">             setTimeout(() =&gt; &#123;</div><div class="line">                    commit(&apos;someMutation&apos;)</div><div class="line">                    resolve()</div><div class="line">                  &#125;, 1000)</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>现在你可以：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">store.dispatch(<span class="string">'actionA'</span>).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>在另外一个 action 中也可以：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">actions: &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  actionB (&#123; dispatch, commit &#125;) &#123;</div><div class="line">    <span class="keyword">return</span> dispatch(<span class="string">'actionA'</span>).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      commit(<span class="string">'someOtherMutation'</span>)</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>最后，如果我们利用 async / await 这个 JavaScript 即将到来的新特性，我们可以像这样组合 action：</p>
<p>假设 getData() 和 getOtherData() 返回的是 Promise<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">actions: &#123;</div><div class="line">  async actionA (&#123; commit &#125;) &#123;</div><div class="line">    commit(&apos;gotData&apos;, await getData())</div><div class="line">  &#125;,</div><div class="line">  async actionB (&#123; dispatch, commit &#125;) &#123;</div><div class="line">    await dispatch(&apos;actionA&apos;) // 等待 actionA 完成</div><div class="line">    commit(&apos;gotOtherData&apos;, await getOtherData())</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="Modules-https-vuex-vuejs-org-zh-cn-modules-html"><a href="#Modules-https-vuex-vuejs-org-zh-cn-modules-html" class="headerlink" title="Modules (https://vuex.vuejs.org/zh-cn/modules.html)"></a>Modules (<a href="https://vuex.vuejs.org/zh-cn/modules.html" target="_blank" rel="external">https://vuex.vuejs.org/zh-cn/modules.html</a>)</h2><h2 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h2><ol>
<li>应用层级的状态应该集中到单个store对象中.</li>
<li>提交mutation是更改状态的位一方法,并且这个过程是同步的.</li>
<li>异步逻辑都应该封装到action里面.</li>
</ol>
<p>对于大型应用,Vuex相关代码分割到模块中.下面是项目结构示例:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">├── index.html</div><div class="line">├── main.js</div><div class="line">├── api</div><div class="line">│   └── ... # 抽取出API请求</div><div class="line">├── components</div><div class="line">│   ├── App.vue</div><div class="line">│   └── ...</div><div class="line">└── store</div><div class="line">    ├── index.js          # 我们组装模块并导出 store 的地方</div><div class="line">    ├── actions.js        # 根级别的 action</div><div class="line">    ├── mutations.js      # 根级别的 mutation</div><div class="line">    └── modules</div><div class="line">        ├── cart.js       # 购物车模块</div><div class="line">        └── products.js   # 产品模块</div></pre></td></tr></table></figure></p>
<h2 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h2>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/05/vue-cli/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王羽彪">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王羽彪 |  学习前端">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/05/vue-cli/" itemprop="url">'vue-cli'</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-05T23:49:49+08:00">
                2017-07-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Vue-cli是Vue的脚手架工具"><a href="#Vue-cli是Vue的脚手架工具" class="headerlink" title="Vue-cli是Vue的脚手架工具"></a>Vue-cli是Vue的脚手架工具</h2><p>帮助我们写好Vue.js基础代码的工具.</p>
<ol>
<li>目录结构</li>
<li>本地调试</li>
<li>代码部署</li>
<li>热加载</li>
<li>单元测试</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install -g cue-cli</div></pre></td></tr></table></figure>
<h2 id="webpack-环境搭建"><a href="#webpack-环境搭建" class="headerlink" title="webpack 环境搭建"></a>webpack 环境搭建</h2><ol>
<li>vue init webpack sell</li>
<li>cd sell</li>
<li>npm install</li>
<li>npm start</li>
</ol>
<h2 id="目录文件"><a href="#目录文件" class="headerlink" title="目录文件"></a>目录文件</h2><ol>
<li>build</li>
<li>config</li>
<li>node_modules 依赖包</li>
<li>src源码<ul>
<li>assets</li>
<li>components</li>
</ul>
</li>
<li>static 静态文件</li>
<li>.babelrc babel编译配置<ul>
<li>“preset” 预设插件</li>
<li>“plugins” 插件</li>
<li>“comments”:false false表示编译后代码不包含注释</li>
</ul>
</li>
<li>editorconfig <ul>
<li>charset 编码</li>
<li>indent_style 缩进风格</li>
<li>indent_size</li>
<li>end_of_line 换行符</li>
<li>inset_final_newline </li>
<li>trim_trailing_whitespace true自动移除行尾多余空格</li>
</ul>
</li>
<li>.eslintignore </li>
<li>.eslintrc.js eslint的配置文件</li>
<li>.gitignore git忽略文件</li>
<li>index.html 主html</li>
<li>package.json 项目描述<ul>
<li>“script” 配置脚本命令</li>
</ul>
</li>
<li>README.md </li>
</ol>
<h2 id="Webpack-打包"><a href="#Webpack-打包" class="headerlink" title="Webpack 打包"></a>Webpack 打包</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">resolve = &#123;</div><div class="line">    <span class="attr">extensions</span>:[<span class="string">''</span>,<span class="string">'js'</span>,<span class="string">'.vue'</span>]<span class="comment">//自动识别后缀</span></div><div class="line">&#125;</div><div class="line">slias <span class="comment">//模板中用到fequire时 通过设置别名来缩短路径长度</span></div></pre></td></tr></table></figure>
<ul>
<li>module <ul>
<li>preLoader </li>
<li>loaders <ul>
<li>include 只针对指定目录编译</li>
<li>exclude 编译时不包含目录</li>
<li>url-loader query{limit 限制大小(超过后形成一个独立文件)}</li>
</ul>
</li>
<li>eslint formatter 查看eslink错误原因</li>
<li>vue:{loader:}</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/01/webpack打包工具/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王羽彪">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王羽彪 |  学习前端">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/01/webpack打包工具/" itemprop="url">webpack打包工具'</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-01T09:09:40+08:00">
                2017-07-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="npm包"><a href="#npm包" class="headerlink" title="npm包"></a>npm包</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">webpack</div><div class="line">$ npm install webpack webpack-dev-server html-webpack-plugin -D</div><div class="line"></div><div class="line">babel</div><div class="line">$ npm install babel-core babel-preset-es2015 babel-preset-stage-0 babel-loader babel-preset-react babel-plugin-transform-decorators-legacy -D</div></pre></td></tr></table></figure>
<ol>
<li>热替换/热加载,当修改代码时,大多情况下所改动的地方会实时反映到页面中,而这个过程并没有刷新页面。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">webpack-dev-server --hot -inline</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><ul>
<li>模块规范/CommonJS、AMD</li>
<li>分支/chunks</li>
<li>加载器/loader</li>
<li>插件/plugins</li>
</ul>
<h3 id="分支"><a href="#分支" class="headerlink" title="分支"></a>分支</h3><p>webpack擅长的是讲台资源的打包,如果希望异步加载,可以通过Code Splitting(裂开)的方式实现<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">require</span>.ensure([<span class="string">'b'</span>],<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> b = <span class="built_in">require</span>(<span class="string">'b'</span>) </div><div class="line">&#125;)</div><div class="line"><span class="comment">//经过webpack打包后,或生成1.js,这里的名字可以配置的</span></div></pre></td></tr></table></figure></p>
<h3 id="加载器"><a href="#加载器" class="headerlink" title="加载器"></a>加载器</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">module:&#123;</div><div class="line">    loaders:[</div><div class="line">        &#123;test:/.js$/,loaders:[&apos;babel-loader&apos;],exclude:/node_modules/&#125;</div><div class="line">    ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="webpack"><a href="#webpack" class="headerlink" title="webpack"></a>webpack</h1><p>webpack是一个模块绑定器，其主要作用是将js文件捆绑在浏览器中,但也可以转换、捆绑、或者打包任何资源和有用的东西</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p><code>npm install --save-dev webpack</code></p>
<h2 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h2><ul>
<li>common-chunks-webpack-plugin 生成entry文点共享的模块(e.g. vendor.bundle.js &amp;&amp; app.bundle.js)</li>
<li>extract-text-webpack-plugin 从bundles提取css文本到一个独立的文件(e.g. app.bundle.css)</li>
<li>component-webpack-plugin 使用webpack组件</li>
<li>compression-webpack-plugin 准备生成压缩版本</li>
<li>i18n-webpack-plugin 为你的bundles加入i18n支持</li>
<li>html-webpack-plugin 为你的bundles加入i18n支持(index.html)<h2 id="file-loaders"><a href="#file-loaders" class="headerlink" title="file loaders"></a>file loaders</h2></li>
<li>raw-loader 加载文件的原内容(utf-8)</li>
<li>val-loader 将代码当多模块执行并且视为js导出</li>
<li>url-loader 像file loader 但是当文件小于限制的大小的时候会返回一个数据地址</li>
<li>file-loader 将文件发送到输出文件夹并返回相对路径(url)<h2 id="JSON-loaders-加载并转发JSON文件"><a href="#JSON-loaders-加载并转发JSON文件" class="headerlink" title="JSON loaders 加载并转发JSON文件"></a>JSON loaders 加载并转发JSON文件</h2><h2 id="transpiling-loaders（将一种源码转换为另一种源码-转译）"><a href="#transpiling-loaders（将一种源码转换为另一种源码-转译）" class="headerlink" title="transpiling loaders（将一种源码转换为另一种源码,转译）"></a>transpiling loaders（将一种源码转换为另一种源码,转译）</h2></li>
<li>script-loader 在全局环境下执行一次js文件(如脚本标签),不需要解析</li>
<li>babel-loader 加载es2015以上版本并且使用Babel转译为ES5</li>
<li>traceur-loader 加载es2015以上版本并且使用Traceur转译为ES5</li>
<li>ts-loader 样js一样加载TypeScript</li>
<li>coffeScript 像js一样加载CoffeeScript<h2 id="templating-loaders"><a href="#templating-loaders" class="headerlink" title="templating loaders"></a>templating loaders</h2></li>
<li>html-loader 将HTML作为字符串导出,需要吧把静态资源当做参考</li>
<li>pug-loader 加载Pug模板并且返回一个函数</li>
<li>jade-loader 加载jade模板并且返回一个函数</li>
<li>markdown-loader 将Markdown转译为HTML</li>
<li>posthtml-loader 使用PostHTML加载并转换HTML文件</li>
<li>handlebars-loader 将Handlebars转译成HTML<h2 id="Styling-loaders"><a href="#Styling-loaders" class="headerlink" title="Styling loaders"></a>Styling loaders</h2></li>
<li>style-loader 将导出的模板作为样式添加到DOM</li>
<li>css-loader 加载通过相对路径使用import导入的CSS文件并且返回CSS代码</li>
<li>less-loader 加载并编译LESS文件</li>
<li>sass-loader 加载并编译SASS文件</li>
<li>stylus-loader 加载并编译Stylus文件</li>
<li>postcss-loader 使用PostCSS加载并转换一个CSS/SSS文件<h2 id="Linting-amp-amp-Testing-loader"><a href="#Linting-amp-amp-Testing-loader" class="headerlink" title="Linting&amp;&amp;Testing loader"></a>Linting&amp;&amp;Testing loader</h2></li>
<li>mocha-loader 用mocha测试(浏览器/node)</li>
<li>eslint-loader 使用ESLint为静态代码的解析(linting code)提供预加载</li>
<li>jsHint-loader 使用JSHint为静态代码的解析提供预加载</li>
<li>jscs-loader 使用JSCS为代码代码样式校验提供预加载<h2 id="framworks-loaders"><a href="#framworks-loaders" class="headerlink" title="framworks loaders"></a>framworks loaders</h2></li>
<li>vue-loader </li>
<li>polymer-loader 处理HTML&amp;&amp;CSS使用预处理器和通过require()导入的Web组件像一级模块一样</li>
<li>angular2-template-loader 加载和转译Angular2组件</li>
<li>tag-loader Riot官方webpack处理器  <h2 id="性能-Performance"><a href="#性能-Performance" class="headerlink" title="性能 Performance"></a>性能 Performance</h2>webpack使用异步的I/O接口,并具有多个缓存级别。这使webpack拥有快速和难以置信的增量编译速度<h2 id="Module-Formats"><a href="#Module-Formats" class="headerlink" title="Module Formats"></a>Module Formats</h2>webpack支持es2015+,CommonJS和AMD模块开箱可用。它对你的代码中的AST执行聪明的静态分析。它甚至有一评估引擎来评估简单的表达。着可以让你即可使用大多数现有的库.<h2 id="Code-Splitting"><a href="#Code-Splitting" class="headerlink" title="Code Splitting"></a>Code Splitting</h2>webpack允你将你的代码库拆分成多个模块.模块在运行的时异步加载,这会减少你的初始加载时间<h2 id="Optimizations-优化"><a href="#Optimizations-优化" class="headerlink" title="Optimizations 优化"></a>Optimizations 优化</h2>webpack 可以许多优化,通过重复使用经常使用的模块进行重复数据的删除,最小化并让你完全控制最初加载的内容并且通过运行时进行代码拆分来减少js输出的大小.它也可以通过hashes让你的代码块缓存友好。</li>
</ul>
<p>(<a href="https://www.npmjs.com/package/webpack)[官方文档" target="_blank" rel="external">https://www.npmjs.com/package/webpack)[官方文档</a>]</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/03/class/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王羽彪">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王羽彪 |  学习前端">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/03/class/" itemprop="url">class'</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-03T10:19:28+08:00">
                2017-06-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/25/redux/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王羽彪">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王羽彪 |  学习前端">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/25/redux/" itemprop="url">'redux'</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-25T10:36:33+08:00">
                2017-05-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="取消订阅"><a href="#取消订阅" class="headerlink" title="取消订阅"></a>取消订阅</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//订阅方法执行后会返回一个取消订阅的函数,用于取消定于</span></div><div class="line">   <span class="keyword">let</span> subscribe = <span class="function">(<span class="params">listener</span>) =&gt;</span> &#123; <span class="comment">//订阅仓库内的状态变化事件,当状态发生变化之后会调用对应的监听函数</span></div><div class="line">       listeners.push(listener);</div><div class="line">       <span class="keyword">return</span> <span class="function"><span class="params">()</span>=&gt;</span>&#123;</div><div class="line">           listeners.filter(<span class="function"><span class="params">l</span>=&gt;</span>&#123;</div><div class="line">               <span class="keyword">return</span> listener!==l;</div><div class="line">           &#125;)</div><div class="line">       &#125;</div><div class="line">   &#125;;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/20/mongoDB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王羽彪">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王羽彪 |  学习前端">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/20/mongoDB/" itemprop="url">'mongoDB'</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-20T10:18:20+08:00">
                2017-05-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://robomongo.org/" target="_blank" rel="external">Robomongo</a></p>
<h2 id="如何启动数据库"><a href="#如何启动数据库" class="headerlink" title="如何启动数据库"></a>如何启动数据库</h2><ol>
<li>新建一个空白目录(非C盘) 比如 d:\mongoData</li>
<li><p>启动服务器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ mongod --dbpath=[filePath]</div></pre></td></tr></table></figure>
</li>
<li><p>连接服务器,在bin目录下执行命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$  mongo</div></pre></td></tr></table></figure>
</li>
<li><p>如何停止数据库</p>
<ul>
<li>切换到admin数据库，并关闭数据库<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ use admin</div><div class="line">$ db.shutdownServer</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>如何查看当前在哪个数据库下面</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">db</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="mongoose"><a href="#mongoose" class="headerlink" title="mongoose"></a>mongoose</h2><ol>
<li><p>加载mongoose模块</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">let mongoose = require(&apos;mongoose&apos;);</div></pre></td></tr></table></figure>
</li>
<li></li>
</ol>
<ul>
<li>客户端 是用来操作数据库的,对数据库中的数据进行增删改查</li>
<li>数据库的连接地址格式:  mongodb://<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/14/cookie/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王羽彪">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王羽彪 |  学习前端">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/14/cookie/" itemprop="url">'cookie'</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-14T11:27:03+08:00">
                2017-05-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/13/express总结/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王羽彪">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王羽彪 |  学习前端">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/13/express总结/" itemprop="url">'express总结'</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-13T19:12:11+08:00">
                2017-05-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-Express介绍"><a href="#1-Express介绍" class="headerlink" title="1.Express介绍"></a>1.Express介绍</h2><p>Express是一个简洁、灵活的node.js Web应用开发框架,是目前最流行的Node.js的Web开发框架,它提供一系列强大的功能,比如:</p>
<ul>
<li>模板解析(render())</li>
<li>静态文件服务(express.static())</li>
<li>中间件(app.use())</li>
<li>路由控制(express.Router)<h2 id="2-使用express"><a href="#2-使用express" class="headerlink" title="2. 使用express"></a>2. 使用express</h2>本地安装<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install express</div></pre></td></tr></table></figure>
</li>
</ul>
<p>获取、引用 通过变量app我们就可以调用express的各种方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">let express = require(&apos;express&apos;)</div><div class="line">let app = express();</div><div class="line">app.listen(port)</div></pre></td></tr></table></figure></p>
<p>? express本质上是什么,是如何工作的呢?</p>
<h2 id="3-get请求"><a href="#3-get请求" class="headerlink" title="3. get请求"></a>3. get请求</h2><p>根据请求路径来处理客户端发出的GET请求 语法<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">app.get(path,(req,res)=&gt;&#123;&#125;)</div></pre></td></tr></table></figure></p>
<ul>
<li>第一个参数path为请求的路径</li>
<li>第二个参数为处理请求的回调函数,有两个参数分别是<ul>
<li>request 请求信息</li>
<li>response 响应信息<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">let express = require(&apos;express&apos;)&apos;</div><div class="line">let app = express();</div><div class="line">app.get(&apos;/&apos;,(req,res)=&gt;&#123;</div><div class="line">    res.end(&apos;welcome to Home!&apos;)</div><div class="line">&#125;)</div><div class="line">app.get(&apos;/list&apos;/(req,res)=&gt;&#123;</div><div class="line">    res.end(&apos;welcome to List&apos;);</div><div class="line">&#125;)</div><div class="line">app.listen(3000);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="4-curl客户端使用方法"><a href="#4-curl客户端使用方法" class="headerlink" title="4.  curl客户端使用方法"></a>4.  curl客户端使用方法</h2><ul>
<li>可以用 <a href="https://www.getpostman.com/" target="_blank" rel="external">postman APIs请求模拟发送</a></li>
<li><p>指定请求头</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ curl -H &apos;content-type:application/json;charset=utf8&apos; http://localhost:8888</div></pre></td></tr></table></figure>
</li>
<li><p>指定方法名</p>
<blockquote>
<p>浏览器的地址行不能发送出post请求</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ curl -X POST http://loaclhost:8000/user</div></pre></td></tr></table></figure>
</blockquote>
</li>
<li><p>指定请求体</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl --data &quot;name=zfpx&amp;age=8&quot; http://loaclhost:8000/user</div></pre></td></tr></table></figure>
<h2 id="all"><a href="#all" class="headerlink" title="all"></a>all</h2><p>app.all()可以匹配所有的HTTP动词 路由中的星号能匹配所有的路径</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">app.all(path,(req,res)=&gt;&#123;&#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
<p>实例:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">let express = require(&apos;express&apos;);</div><div class="line">let app = express();</div><div class="line">app.all(&apos;*&apos;,(req,res)=&gt;&#123;</div><div class="line">        send(404)</div><div class="line">    &#125;)</div></pre></td></tr></table></figure></p>
<h2 id="6-获取请求参数"><a href="#6-获取请求参数" class="headerlink" title="6. 获取请求参数"></a>6. 获取请求参数</h2><ul>
<li>req.host 返回请求头里取的主机名(不包含port)</li>
<li>req.path URL的路径名</li>
<li>req.query <h2 id="7-获得查询字符串"><a href="#7-获得查询字符串" class="headerlink" title="7. 获得查询字符串"></a>7. 获得查询字符串</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">// http://localhost:3000/?a=1&amp;&amp;c=3</div><div class="line">app.get(&apos;/&apos;,(req,res)=&gt;&#123;</div><div class="line">        res.send(req.query)</div><div class="line">    &#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="8-params路径参数"><a href="#8-params路径参数" class="headerlink" title="8. params路径参数"></a>8. params路径参数</h2><p>req.params 可以用来获取请求URL中的参数值<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">    app.get(/:aid/:name,(req,res)=&gt;&#123;</div><div class="line">        res.send(req.params.id + &apos;&apos; + req.params.name)</div><div class="line">    &#125;)</div><div class="line">    </div><div class="line">    //http://localhost:3000/6/wang</div><div class="line">    //params = &#123;aid:6,name=&apos;wang&apos;&#125;</div><div class="line">```    </div><div class="line">## 9. 中间件</div><div class="line">中间件就是处理HTTp请求的函数,用来完成各种特定的任务,比如检查用户是否登录,检测用户是否有访问权限等,它的特点是:</div><div class="line"> - 一个中间件处理完请求和响应可以把响应数据再传递给下一个中间件</div><div class="line"> - 回调函数next参数,表示接受其他中间件的调用,函数体中的next()表示将请求数据传递给下一个中间件</div><div class="line"> - 还可以根据路径来区分进行返回执行不同的中间件</div><div class="line"> ```$xslt</div><div class="line">    let express = require(&apos;express&apos;);</div><div class="line">    let app = rexpress();</div><div class="line">    let path = require(&apos;path&apos;);</div><div class="line">    </div><div class="line">    app.use((req,res,next)=&gt;&#123;</div><div class="line">        res.setHeader(&apos;Content-Type&apos;,&apos;text/plain;charset=utf8);</div><div class="line">        next()</div><div class="line">    &#125;)</div><div class="line">    </div><div class="line">    app.get(&apos;/&apos;,(req,res)=&gt;&#123;</div><div class="line">        res.end(&apos;首页&apos;);</div><div class="line">    &#125;)</div><div class="line">    app.get(&apos;/list/,(req,res)=&gt;&#123;</div><div class="line">        res.end(&apos;这是列表页&apos;);</div><div class="line">    &#125;)</div><div class="line">    app.listen(3000)</div></pre></td></tr></table></figure></p>
<h2 id="10-send"><a href="#10-send" class="headerlink" title="10. send"></a>10. send</h2><p>send()想浏览器发送一个响应信息,并可以智能处理不同数据类型的，并在输出响应时会自动进行一些设置,比如HEAD信息, HTTP缓存处理不同类型的数据.语法:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">res.send([resBody|status],[body])</div></pre></td></tr></table></figure></p>
<ol>
<li><p>实例一: 当参数为一个String时,Content-Type默认设置为’text/html’.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">res.send(&apos;Hello World&apos;); // Hello World</div></pre></td></tr></table></figure>
</li>
<li><p>当参数为Array或Object时,Express会返回一个JSON</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">res.send(&#123;user:&apos;tobi&apos;&#125;) // &#123;&quot;user&quot;:&quot;tobi&quot;&#125;</div><div class="line">res.send([1,2,3]) //[1,2,3]</div></pre></td></tr></table></figure>
</li>
<li><p>当参数为一个Number时, 并且没有上面提到的任何一条在响应体力,Express会 帮你设置一个响应体,比如：200会返回字符串”OK”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">res.send(200); //OK</div><div class="line">res.send(404); //NOT FOUND</div><div class="line">res.send(500); //Internal Server Error</div></pre></td></tr></table></figure>
</li>
<li><p>可以查看statusCode所对应的状态类型</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">require(&apos;_http_server&apos;).STATUS_CODES</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="11-模板"><a href="#11-模板" class="headerlink" title="11. 模板"></a>11. 模板</h2><p>在nodejs中使用expres框架,它默认的是ejs和jade渲染模板</p>
<h3 id="11-2使用模板"><a href="#11-2使用模板" class="headerlink" title="11.2使用模板"></a>11.2使用模板</h3><p>使用ejs模板 -&gt; 默认指向views文件夹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">//指定渲染模板文件的后缀名为ejs</div><div class="line"></div><div class="line">app.set(&apos;view engine&apos;,&apos;html&apos;);</div><div class="line">app.set(&apos;views&apos;,path.join(__dirname,&apos;views&apos;))</div><div class="line">app.set(&apos;index&apos;);</div></pre></td></tr></table></figure></p>
<p>模板使用html后缀<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">//指定渲染模板文件的后缀名为html</div><div class="line"></div><div class="line">app.set(&apos;views&apos;,&apos;view&apos;);</div><div class="line">app.set(&apos;view engine&apos;,&apos;html&apos;);</div><div class="line">app.set(&apos;html&apos;,&apos;require(&apos;ejs&apos;).__express&apos;);</div></pre></td></tr></table></figure></p>
<h3 id="11-3渲染视图"><a href="#11-3渲染视图" class="headerlink" title="11.3渲染视图"></a>11.3渲染视图</h3><p>语法:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">res.render(view,&#123;...locals&#125;,callback)</div></pre></td></tr></table></figure></p>
<ul>
<li>参数view就是模板的文件名</li>
<li>在渲染模板时将自定义的data对象和在中间件中定义的locals对象,使用Object.assign(obj1,locals)合并后的属性集作为模板变量值传入</li>
<li>callback 用来处理返回的渲染后的字符串<h3 id="11-4-模板原理"><a href="#11-4-模板原理" class="headerlink" title="11.4 模板原理"></a>11.4 模板原理</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">let tmp1 = `&lt;h1&gt;&#123;&#123;name&#125;&#125;&lt;/h1&gt;&lt;h1&gt;&#123;&#123;age&#125;&#125;&lt;/h1&gt;`</div><div class="line">let data = &#123;name:&apos;wang&apos;,age:18&#125;;</div><div class="line">let html = tmp1.replace(/\&#123;\&#123;(\w+)\&#125;\&#125;/g,function(input,group)&#123;</div><div class="line">       return data[group];</div><div class="line">   &#125;)</div><div class="line">console.log(html); //`&lt;h1&gt;wang&lt;/h1&gt;&lt;h1&gt;age&lt;/h1&gt;`</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="12-静态文件服务器"><a href="#12-静态文件服务器" class="headerlink" title="12. 静态文件服务器"></a>12. 静态文件服务器</h3><p>如果要在网页中加载静态文件(css,js,img),就需要另外指定一个存放静态文件的目录,当浏览器发出非HTML文件请求时,服务器端就会到这个目录下去寻找相关文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">app.use(express.static(path.join(__dirname,&apos;/&apos;)))</div><div class="line">app.use(express.static(&apos;public&apos;))</div></pre></td></tr></table></figure></p>
<h3 id="13-重定向"><a href="#13-重定向" class="headerlink" title="13. 重定向"></a>13. 重定向</h3><p>redirect 方法允许网址的重定向<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">res.redirect([status],url);</div></pre></td></tr></table></figure></p>
<p>实例:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">res.redirect(&apos;http://www.baidu.com&apos;)</div></pre></td></tr></table></figure></p>
<h3 id="14-POST-请求"><a href="#14-POST-请求" class="headerlink" title="14. POST 请求"></a>14. POST 请求</h3><p>post 方法根据请求路径来处理客户端发出的Post请求 语法:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">app.post(path,(req,res)=&gt;&#123;&#125;)</div></pre></td></tr></table></figure></p>
<p>示例:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">let bodyParser = require(&apos;body-parser&apos;);</div><div class="line">app.use(bodyParser.urlencoded(&#123;extented:true&#125;));</div><div class="line">app.post(&apos;/login&apos;,(req,res)=&gt;&#123;</div><div class="line">        console.log(req.body.username)</div><div class="line">    &#125;)</div></pre></td></tr></table></figure></p>
<h2 id="16-中间件的原理"><a href="#16-中间件的原理" class="headerlink" title="16. 中间件的原理"></a>16. 中间件的原理</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">let app = (req,res) =&gt;&#123;</div><div class="line">    let index = 0;</div><div class="line">    function next()&#123;</div><div class="line">        let fn = app.routes[index++];</div><div class="line">        if(typeof fn ===&apos;function&apos;) fn(req,res,next);         </div><div class="line">    &#125;</div><div class="line">    next();</div><div class="line">&#125;</div><div class="line">app.routes =[];</div><div class="line">app.use = (fn)&#123;</div><div class="line">    app.routes.push(fn);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="17-params原理"><a href="#17-params原理" class="headerlink" title="17.params原理"></a>17.params原理</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"> //path为路由的路径</div><div class="line"> let path = &apos;/users/:name/:age</div><div class="line"> //客户端发送的url</div><div class="line"> let url = &apos;/users/wang/18&apos;;</div><div class="line"> </div><div class="line"> let paramKeys =[];</div><div class="line"> let regStr - path.replace(/:(\w+)/g,(matchedStr,group1)&#123;</div><div class="line">     paramKeys.push(group1)</div><div class="line">     return &apos;(\\w+)&apos;;</div><div class="line"> &#125;)</div><div class="line"> </div><div class="line"> console.log(regStr); //     /users/(\w+)/(\w+)</div><div class="line"> let reg = new RegExp(regStr); //    /\/users\/(\w+)\/(\w+)/</div><div class="line"> let result = url.match(reg); </div><div class="line"> //[ &apos;/users/zfpx/8&apos;, &apos;zfpx&apos;, &apos;8&apos;, index: 0, input: &apos;/users/zfpx/8&apos; ]</div><div class="line"> </div><div class="line"> let params = &#123;&#125;;</div><div class="line"> for(let i = 0;i&lt;paramKeys.length;i++)&#123;</div><div class="line">     params[paramKeys[i] = result[i+1];</div><div class="line"> &#125;</div><div class="line"></div><div class="line">console.log(params); //&#123;&apos;name&apos;:&apos;wang&apos;,&apos;age&apos;:18&#125;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/13/express/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王羽彪">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王羽彪 |  学习前端">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/13/express/" itemprop="url">'express'</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-13T09:37:54+08:00">
                2017-05-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="express是后台框架"><a href="#express是后台框架" class="headerlink" title="express是后台框架"></a>express是后台框架</h2><ul>
<li>帮我们解决了手动搭建服务,处理复杂的逻辑</li>
<li>express 是一个函数,执行后返回的是一个监听函数</li>
<li>get 要求路径必须绝对匹配到,use匹配开头即可</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm init -y</div><div class="line">npm install express --save</div></pre></td></tr></table></figure>
<p><a href="https://www.getpostman.com/" target="_blank" rel="external">postman 服务端APIs模拟请求工具</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">请求API命令行</div><div class="line">$ curl -X POST http://localhost:8080/home</div></pre></td></tr></table></figure></p>
<h2 id="express-提供的属性"><a href="#express-提供的属性" class="headerlink" title="express 提供的属性"></a>express 提供的属性</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">req.path</div><div class="line">req.query</div><div class="line">req.method</div><div class="line">req.headers</div></pre></td></tr></table></figure>
<h2 id="路径参数params"><a href="#路径参数params" class="headerlink" title="路径参数params"></a>路径参数params</h2><ul>
<li>:id 表示站位必须要有<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">app.get(&apos;/article/:id&apos;,callback)</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="listen"><a href="#listen" class="headerlink" title="listen"></a>listen</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">app.listen(3000);//可以直接使用app监听端口号,如果没有找到对应的逻辑 会出现cannot [request.method]/[pathname]</div><div class="line"></div><div class="line">/*app.listen=function () &#123;</div><div class="line">  let server = require(&apos;http&apos;).createServer(this);</div><div class="line">  server.listen(...arguments);</div><div class="line">&#125;;*/</div></pre></td></tr></table></figure>
<h2 id="all"><a href="#all" class="headerlink" title="all"></a>all</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">// all 代表所有匹配的方法,*代表所有路径都可以匹配到,一般用来配置404页面,放到所有路由最下面,否则会被截断</div><div class="line">app.all(&apos;/*&apos;,function (req,res) &#123;</div><div class="line">   res.end(&apos;404&apos;)</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="use-叫中间件-路由"><a href="#use-叫中间件-路由" class="headerlink" title="use 叫中间件 , 路由"></a>use 叫中间件 , 路由</h2><h2 id="use-叫中间件-路由-1"><a href="#use-叫中间件-路由-1" class="headerlink" title="use 叫中间件 , 路由"></a>use 叫中间件 , 路由</h2><ul>
<li><blockquote>
<p>默认不写路径热呢请求都能进行匹配</p>
</blockquote>
</li>
<li>中间件在路由最上面执行,先执行中间件 ，再执行路由</li>
</ul>
<ol>
<li>可以写路径,还可以不写路径,不写路径默认是/</li>
<li>可以拓展属性和方法 类似于 req.path req.query</li>
<li>可以决定是否向下执行next,若果调用next则可以向下执行 </li>
<li><blockquote>
<p>做权限判断</p>
</blockquote>
</li>
<li>从中间件道路有的过程reg和res是同一个,而且中间件可以写多个<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">app.use((req,res,next)=&gt;&#123;</div><div class="line">    //next 是一个函数,如果调用则据需执行</div><div class="line">    console.log(&apos;hello&apos;);</div><div class="line">    res.end(&apos;66666&apos;);   //如果调用end代码不会继续执行</div><div class="line">    next(); //如果要使用use扩展属性或者方法,一定调用next</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="send"><a href="#send" class="headerlink" title="send()"></a>send()</h2><ol>
<li>可以自动发送json</li>
<li>可以自动处理编码类型</li>
<li>数字会转化成状态文本</li>
</ol>
<blockquote>
<p>用send取代end</p>
</blockquote>
<h2 id="express-提供了静态服务中间件"><a href="#express-提供了静态服务中间件" class="headerlink" title="express 提供了静态服务中间件"></a>express 提供了静态服务中间件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">app.use(express.static(&apos;public&apos;));  //静态文件中间件可以配置多个</div></pre></td></tr></table></figure>
<h2 id="sendFile"><a href="#sendFile" class="headerlink" title="sendFile"></a>sendFile</h2><ul>
<li>向客户端返回单一页面<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">res.sendFile(path.resolve(&apos;./index.html&apos;));</div><div class="line">res.sendFile(&apos;./index.html&apos;,&#123;root:__dirname&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="静态服务中间件"><a href="#静态服务中间件" class="headerlink" title="静态服务中间件"></a>静态服务中间件</h2><p><code>app.use(express.static(路径))</code></p>
<h2 id="动态渲染ejs"><a href="#动态渲染ejs" class="headerlink" title="动态渲染ejs"></a>动态渲染ejs</h2><ul>
<li><p>ejs -&gt;基于html,可以渲染动态数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install ejs --save</div></pre></td></tr></table></figure>
</li>
<li><p>jade </p>
</li>
</ul>
<h2 id="ejs-–-gt-后端渲染"><a href="#ejs-–-gt-后端渲染" class="headerlink" title="ejs –&gt; 后端渲染``"></a>ejs –&gt; 后端渲染``</h2><ul>
<li><code>&lt;%js代码%&gt;</code></li>
<li><code>&lt;%=渲染的数据%&gt;</code><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"> app.set(<span class="string">'views'</span>,<span class="string">'view'</span>); <span class="comment">//默认为views文件,需要手动更改</span></div><div class="line">app.set(<span class="string">'view engine'</span>,<span class="string">'html'</span>);  <span class="comment">//更改渲染的引擎,默认为ejs</span></div><div class="line">app.engine(<span class="string">'html'</span>,<span class="built_in">require</span>(<span class="string">'ejs'</span>).__express); <span class="comment">//对设置后的引擎</span></div><div class="line">app.get(<span class="string">'/'</span>,(req,res)=&gt;&#123;</div><div class="line">   res.render(<span class="string">'index.html'</span>,  <span class="comment">//会默认去views查找</span></div><div class="line">       <span class="comment">//param1:要渲染的模板</span></div><div class="line">       <span class="comment">// 渲染时采用什么数据</span></div><div class="line">       &#123;</div><div class="line">           <span class="attr">data</span>:<span class="string">'666666!'</span>,</div><div class="line">           <span class="attr">arr</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</div><div class="line">       &#125;)</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="body-parser-第三方form数据解析插件"><a href="#body-parser-第三方form数据解析插件" class="headerlink" title="body-parser 第三方form数据解析插件"></a>body-parser 第三方form数据解析插件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$npm install body-parser --save</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/10/vue-webpack/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王羽彪">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王羽彪 |  学习前端">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/10/vue-webpack/" itemprop="url">'vue-webpack'</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-10T09:40:26+08:00">
                2017-05-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="webpack"><a href="#webpack" class="headerlink" title="webpack"></a>webpack</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install webpack webpack-dev-server --save-dev</div></pre></td></tr></table></figure>
<h2 id="babel"><a href="#babel" class="headerlink" title="babel"></a>babel</h2><ul>
<li>通过.vue文件创建组件<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install babel-core babel-loader babel-preset-es2015 babel-preset-stage-0 css-loader vue-loader --save-dev</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="plugin"><a href="#plugin" class="headerlink" title="plugin"></a>plugin</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install html-webpack-plugin vue-template-compiler --save-dev</div></pre></td></tr></table></figure>
<h2 id="vue"><a href="#vue" class="headerlink" title="vue"></a>vue</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install  vue vue-router --save</div></pre></td></tr></table></figure>
<h2 id="vue的使用方式"><a href="#vue的使用方式" class="headerlink" title="vue的使用方式"></a>vue的使用方式</h2><ul>
<li>直接使用vue写代码</li>
<li>工程化的方式</li>
</ul>
<p>##<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm install vue-cli -g</div><div class="line">npm init webpack &lt;filename&gt;</div></pre></td></tr></table></figure></p>
<ul>
<li>项目名默认</li>
<li>描述默认</li>
<li>作者默认</li>
<li>RUNTIME+compiler(默认第一个)</li>
<li>eslink(n)</li>
<li>karma+mocha n</li>
<li><p>e2e n</p>
<h2 id="安装全部依赖"><a href="#安装全部依赖" class="headerlink" title="安装全部依赖"></a>安装全部依赖</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cd &lt;filename&gt; &amp;&amp; npm install</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="安装vuex"><a href="#安装vuex" class="headerlink" title="安装vuex"></a>安装vuex</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install vuex   --save</div></pre></td></tr></table></figure>
<p>##<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://chrome.google.com/webstore/detail/vuejs-devtools/nhdogjmejiglipccpnnnanhbledajbpd</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="王羽彪" />
          <p class="site-author-name" itemprop="name">王羽彪</p>
           
              <p class="site-description motion-element" itemprop="description">技术 | javascript | html | 前端学习</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">47</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">77</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">王羽彪</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  





  

  

  

  

  

  

</body>
</html>
